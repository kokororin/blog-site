!function(t,e,a){var o=t.mori;if(!o){var n=function(){NProgress.configure({showSpinner:!1})};n.prototype.getHitokoto=function(){a.ajax({url:"https://api.imjad.cn/hitokoto/"}).then(function(t){a("#hitokoto").html("Hitokoto&nbsp; Â· &nbsp;&nbsp;"+t)})},n.prototype.updateLinks=function(){a("a").each(function(t,e){var o=a(e),n=o.attr("href");return!n||(n&&0===n.indexOf(MORI_VARS.url)?(n=""===(n=n.replace(MORI_VARS.url,""))?"/":n,o.attr("href",n),!0):"javascript:"===n.substring(0,11)||"#"===n.substring(0,1)||"/"===n.substring(0,1)||void o.attr("target","_blank"))})},n.prototype.initDom=function(){if(a("#main-index").fadeIn(800),a("#main-archive").fadeIn(800),a("#main-post").fadeIn(500),a("#postnav").fadeIn(800),a("#main-page").fadeIn(500),a("#pagenav").fadeIn(800),a("#bottomtools").fadeIn(1200),""!==t.location.hash){var e=t.location.hash.indexOf("#disqus_thread"),o=t.location.hash.indexOf("#respond-post");-1===e&&-1===o||a("#disqus_thread").fadeIn(1e3)}a("#footer").css("display","block"),a('[data-toggle="tooltip"]').tooltip(),a('[data-toggle="dropdown"]').dropdown(),MORI_VARS.bottomTools.hitokoto&&a("#hitokoto").length>0&&this.getHitokoto()},n.prototype.bindDom=function(){a(e).on("click",'[data-action="comment-show"]',function(){a("#disqus_thread").fadeIn(1e3)}),a(e).on("click",'[data-action="comment-go"]',function(){a("#disqus_thread").fadeIn(1e3)}),a(e).on("click",'[data-action="show-tor"]',function(){"none;"===a(".post-tor").css("display")?(a(".post-tor").fadeIn(400),a(".post-tor").css("display","inline-block")):a(".post-tor").fadeOut(400)}),a(e).on("click","a[href*=#][href!=#],area[href*=#][href!=#]",function(){if($body=t.opera?"CSS1Compat"===e.compatMode?a("html"):a("body"):a("html,body"),location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname&&location.search===this.search){var o=a(this.hash);if((o=o.length&&o||a("[name="+this.hash.slice(1)+"]")).length){var n=o.offset().top;return a("html,body").animate({scrollTop:n},1e3),!1}}})},n.prototype.initDisqus=function(){var o,n;"disqus"===MORI_VARS.comment.use&&a("#disqus_thread").length>0&&"false"!==a("#disqus_thread").attr("data-allow-comment")&&(t.disqus_config=function(){this.page.url=a("#disqus_thread").attr("data-permalink"),this.page.identifier=a("#disqus_thread").attr("data-permalink"),this.page.title=a("#disqus_thread").attr("data-title")},t.DISQUS?DISQUS.reset({reload:!0,config:disqus_config}):((n=(o=e).createElement("script")).src="//"+MORI_VARS.comment.shortname+".disqus.com/embed.js",n.setAttribute("data-timestamp",+new Date),(o.head||o.body).appendChild(n)))},n.prototype.analytics=function(){var a,o,n,i,s,r;"google"===MORI_VARS.analytics.use&&(o=e,n="script",i="ga",(a=t).GoogleAnalyticsObject=i,a.ga=a.ga||function(){(a.ga.q=a.ga.q||[]).push(arguments)},a.ga.l=1*new Date,s=o.createElement(n),r=o.getElementsByTagName(n)[0],s.async=1,s.src="//www.google-analytics.com/analytics.js",r.parentNode.insertBefore(s,r),t.ga&&(t.ga("create",MORI_VARS.analytics.id,"auto"),t.ga("send","pageview")))},n.prototype.initPjax=function(){Pjax.isSupported()&&(new Pjax({elements:"a[href]:not([data-nopjax]):not([data-toggle])",selectors:["title","#pjax-container"],cacheBust:!1}),e.addEventListener("pjax:send",function(){o.loadingStart()}),e.addEventListener("pjax:success",function(){t.ga&&t.ga("send","pageview",{page:t.location.pathname+t.location.search,title:e.title}),o.initDom(),o.initDisqus(),o.updateLinks()}),e.addEventListener("pjax:complete",function(){o.loadingEnd()}),t.addEventListener("popstate",function(){o.initDom()}))},n.prototype.loadingStart=function(){NProgress.start()},n.prototype.loadingEnd=function(){setTimeout(NProgress.done,500)},n.prototype.run=function(){this.initDom(),this.bindDom(),this.initDisqus(),this.updateLinks(),e.addEventListener("DOMContentLoaded",function(){o.initPjax()}),this.loadingStart(),e.addEventListener("readystatechange",function(){"complete"===e.readyState&&(setTimeout(o.loadingEnd,500),o.analytics())})},(o=new n).run(),t.mori=o}}(window,document,jQuery);