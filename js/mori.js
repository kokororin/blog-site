"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}!function(l,o){var t=l.MORI_INSTANCE,a=l.MORI_VARS,n=l.NProgress,i=l.Pjax,s=function(){function u(e){_classCallCheck(this,u),e&&"string"!=typeof e?(this.element=e,this.elements=[this.element],this.length=1):"string"==typeof e&&(this.element=o.querySelector(e),this.elements=o.querySelectorAll(e),this.length=this.elements.length),this.element||(this.element=o.createElement("mori"),this.elements=[],this.length=0)}return _createClass(u,[{key:"show",value:function(){return this.element.style.display="block",this}},{key:"hide",value:function(){return this.element.style.display="none",this}},{key:"html",value:function(e){return this.element.innerHTML=e,this}},{key:"addClass",value:function(e){return this.element.classList.add(e),this}},{key:"removeClass",value:function(e){return this.element.classList.remove(e),this}},{key:"hasClass",value:function(e){return this.element.classList.contains(e)}},{key:"css",value:function(e,t){return t?(this.element.style[e]=t,this):getComputedStyle(this.element)[e]}},{key:"attr",value:function(e,t){return t?(this.element.setAttribute(e,t),this):this.element.getAttribute(e)}},{key:"each",value:function(n){return Array.prototype.forEach.call(this.elements,function(e,t){return n.call(e,e,t)}),this}},{key:"parent",value:function(e){for(var t=this.element.parentNode;t!==o;){var n=t;if(u.select(t).hasClass(e))return u.select(t);if(!n.parentNode)break;t=n.parentNode}return u.select(null)}},{key:"on",value:function(e,a,t){var r=this,c=2<arguments.length&&void 0!==t?t:function(){};return this.element.addEventListener(e,function(e){for(var t=r.element.querySelectorAll(a),n=e.target,i=0,s=t.length;i<s;i++)for(var o=n,l=t[i];o&&o!==r.element;){if(o===l)return c.call(l,e,u.select(o));o=o.parentNode}}),this}},{key:"scrollTo",value:function(){var n=this.element.getBoundingClientRect().top,i=l.pageYOffset,s=n+i,o=+new Date;return requestAnimationFrame(function e(){var t=new Date-o;l.scrollTo(0,i+n*(t/500)),e.timer=requestAnimationFrame(e),500<=t&&(l.scrollTo(0,s),cancelAnimationFrame(e.timer))}),this}},{key:"slideUp",value:function(e){var t=this,n=0<arguments.length&&void 0!==e?e:500;this.element.style.transitionProperty="height, margin, padding",this.element.style.transitionDuration=n+"ms",this.element.style.boxSizing="border-box",this.element.style.height=this.element.offsetHeight+"px",this.element.offsetHeight,this.element.style.overflow="hidden",this.element.style.height="0px",this.element.style.paddingTop="0px",this.element.style.paddingBottom="0px",this.element.style.marginTop="0px",this.element.style.marginBottom="0px",setTimeout(function(){t.element.style.display="none",t.element.style.removeProperty("height"),t.element.style.removeProperty("padding-top"),t.element.style.removeProperty("padding-bottom"),t.element.style.removeProperty("margin-top"),t.element.style.removeProperty("margin-bottom"),t.element.style.removeProperty("overflow"),t.element.style.removeProperty("transition-duration"),t.element.style.removeProperty("transition-property")},n)}},{key:"slideDown",value:function(e){var t=this,n=0<arguments.length&&void 0!==e?e:500;this.element.style.removeProperty("display");var i=l.getComputedStyle(this.element).display;"none"===i&&(i="block"),this.element.style.display=i;var s=this.element.offsetHeight;this.element.style.overflow="hidden",this.element.style.height="0px",this.element.style.paddingTop="0px",this.element.style.paddingBottom="0px",this.element.style.marginTop="0px",this.element.style.marginBottom="0px",this.element.offsetHeight,this.element.style.boxSizing="border-box",this.element.style.transitionProperty="height, margin, padding",this.element.style.transitionDuration=n+"ms",this.element.style.height=s+"px",this.element.style.removeProperty("padding-top"),this.element.style.removeProperty("padding-bottom"),this.element.style.removeProperty("margin-top"),this.element.style.removeProperty("margin-bottom"),setTimeout(function(){t.element.style.removeProperty("height"),t.element.style.removeProperty("overflow"),t.element.style.removeProperty("transition-duration"),t.element.style.removeProperty("transition-property")},n)}},{key:"slideToggle",value:function(e){var t=0<arguments.length&&void 0!==e?e:500;return"none"===getComputedStyle(this.element).display?this.slideDown(t):this.slideUp(t)}}],[{key:"select",value:function(e){return new u(e)}}]),u}(),e=function(){function e(){_classCallCheck(this,e),n.configure({showSpinner:!1})}return _createClass(e,[{key:"getHitokoto",value:function(){var e=new XMLHttpRequest;e.open("GET","https://api.imjad.cn/hitokoto/"),e.addEventListener("load",function(){s.select("#hitokoto").html("Hitokoto&nbsp; Â· &nbsp;&nbsp;"+e.responseText)}),e.send()}},{key:"updateLinks",value:function(){s.select("a").each(function(e){var t=e.getAttribute("href");return!t||(t&&0===t.indexOf(a.url)?(t=""===(t=t.replace(a.url,""))?"/":t,e.href=t,!0):"javascript:"===t.substring(0,11)||"#"===t.substring(0,1)||"/"===t.substring(0,1)||void(e.target="_blank"))})}},{key:"initDom",value:function(){""!==l.location.hash&&-1!==l.location.hash.indexOf("#comment")&&s.select("#disqus_thread").show();a.bottomTools.hitokoto&&0<s.select("#hitokoto").length&&this.getHitokoto()}},{key:"bindDom",value:function(){s.select(o).on("click",'[data-action="comment-show"]',function(e){e.preventDefault(),s.select("#disqus_thread").show()}),s.select(o).on("click",'[data-action="comment-go"]',function(e){e.preventDefault(),s.select("#disqus_thread").show().scrollTo()}),s.select(o).on("click",'[data-toggle="dropdown"]',function(e){e.preventDefault(),e.stopPropagation();var t=s.select(e.target).parent("dropup");t.hasClass("open")?t.removeClass("open"):t.addClass("open")}),s.select(o).on("click","body",function(e){0===s.select(e.target).parent("dropup").length&&s.select(".dropup.open").removeClass("open")}),s.select(o).on("click",'[data-toggle="collapse"]',function(e,t){e.preventDefault(),s.select('.collapse[data-collapse-id="'.concat(t.attr("data-collapse-id"),'"]')).slideToggle()})}},{key:"initDisqus",value:function(){var e,t;"disqus"===a.comment.use&&0<s.select("#disqus_thread").length&&"false"!==s.select("#disqus_thread").attr("data-allow-comment")&&(l.disqus_config=function(){this.page.url=s.select("#disqus_thread").attr("data-permalink"),this.page.identifier=s.select("#disqus_thread").attr("data-permalink"),this.page.title=s.select("#disqus_thread").attr("data-title")},l.DISQUS?l.DISQUS.reset({reload:!0,config:l.disqus_config}):((t=(e=o).createElement("script")).src="//"+a.comment.shortname+".disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)))}},{key:"analytics",value:function(){var e,t,n,i,s;"google"===a.analytics.use&&(t=o,n="ga",(e=l).GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,i=t.createElement("script"),s=t.getElementsByTagName("script")[0],i.async=1,i.src="//www.google-analytics.com/analytics.js",s.parentNode.insertBefore(i,s),l.ga&&(l.ga("create",a.analytics.id,"auto"),l.ga("send","pageview")))}},{key:"initPjax",value:function(){i.isSupported()&&(new i({elements:"a[href]:not([data-nopjax]):not([data-toggle])",selectors:["title","#pjax-container"],cacheBust:!1}),o.addEventListener("pjax:send",function(){t.loadingStart()}),o.addEventListener("pjax:success",function(){l.ga&&l.ga("send","pageview",{page:l.location.pathname+l.location.search,title:o.title}),t.initDom(),t.initDisqus(),t.updateLinks()}),o.addEventListener("pjax:complete",function(){t.loadingEnd()}),l.addEventListener("popstate",function(){t.initDom()}))}},{key:"loadingStart",value:function(){n.start()}},{key:"loadingEnd",value:function(){setTimeout(n.done,500)}},{key:"run",value:function(){this.initDom(),this.bindDom(),this.initDisqus(),this.updateLinks(),o.addEventListener("DOMContentLoaded",function(){t.initPjax()}),this.loadingStart(),o.addEventListener("readystatechange",function(){"complete"===o.readyState&&(setTimeout(t.loadingEnd,500),t.analytics())})}}]),e}();t||((t=new e).run(),l.MORI_INSTANCE=t)}(window,document);